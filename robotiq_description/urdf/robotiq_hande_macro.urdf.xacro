<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="gripper_finger">

    <!-- Colour definations-->
    <material name="gray">
      <color rgba="0.7 0.7 0.7 1.0"/>
    </material>
    <material name="dark">
      <color rgba=".1 0.1 0.1 1.0"/>
    </material>

    <!-- Gripper macro hand-e -->
    <xacro:macro name="robotiq_hande" params="prefix parent *origin">
        <link name="${prefix}hand_e_base_link">
            <inertial>
              <origin rpy="0 0 0" xyz="0 0 0.04607"/>
              <mass value="0.86387"/>
              <inertia ixx="1017560E-9" ixy="0" ixz="2235E-9" iyy="1028041E-9" iyz="0" izz="489810E-9"/>
            </inertial>
            <visual>
                <origin rpy="0 0 0" xyz="0 0 0"/>
                <geometry>
                    <mesh filename="package://robotiq_description/meshes/visual/hande/hand-e.dae" scale="1.0 1.0 1.0"/>
                </geometry>
                <material name="dark" />
            </visual>
            <collision>
                <origin rpy="0 0 0" xyz="0 0 0"/>
                <geometry>
                    <mesh filename="package://robotiq_description/meshes/collision/hande/hand-e.stl" scale="1.0 1.0 1.0"/>
                </geometry>
            </collision>
        </link>
        <joint name="${prefix}robotiq_hande_base_joint" type="fixed">
            <parent link="${parent}"/>
            <child link="${prefix}hand_e_base_link"/>
            <xacro:insert_block name="origin"/>
        </joint>

        <!-- Fingers -->
        <link name="${prefix}hande_left_finger">
            <visual>
              <origin rpy="0 0 0" xyz="0 0 0"/>
              <geometry>
                <mesh filename="package://robotiq_description/meshes/visual/hande/left_finger.dae" />
              </geometry>
              <material name="gray">
                <color rgba="0.7 0.7 0.7 1.0"/>
              </material>
            </visual>
            <collision>
              <origin rpy="0 0 0" xyz="0 0 0"/>
              <geometry>
                <mesh filename="package://robotiq_description/meshes/collision/hande/left_finger.stl" />
              </geometry>
            </collision>
          </link>
          <link name="${prefix}hande_right_finger">
            <visual>
              <origin rpy="0 0 0" xyz="0 0 0"/>
              <geometry>
                <mesh filename="package://robotiq_description/meshes/visual/hande/right_finger.dae" />
              </geometry>
              <material name="gray">
                <color rgba="0.7 0.7 0.7 1.0"/>
              </material>
            </visual>
            <collision>
              <origin rpy="0 0 0" xyz="0 0 0"/>
              <geometry>
                <mesh filename="package://robotiq_description/meshes/collision/hande/right_finger.stl" />
              </geometry>
            </collision>
        </link>
        <joint name="${prefix}hande_left_finger_joint" type="prismatic">
            <origin rpy="0 0 0" xyz="0 0 0.099"/>
            <parent link="${prefix}hand_e_base_link"/>
            <child link="${prefix}hande_left_finger"/>
            <axis xyz="-1 0 0"/>
            <limit effort="130" lower="0" upper="0.025" velocity="0.15"/>
          </joint>
        <joint name="${prefix}hande_right_finger_joint" type="prismatic">
            <origin rpy="0 0 0" xyz="0 0 0.099"/>
            <parent link="${prefix}hand_e_base_link"/>
            <child link="${prefix}hande_right_finger"/>
            <axis xyz="1 0 0"/>
            <limit effort="130" lower="0" upper="0.025" velocity="0.15"/>
            <mimic joint="${prefix}hande_left_finger_joint" multiplier="1" offset="0"/>
          </joint>

          <!-- TODO (Manuel) Remove this tmp tcp_link -->
          <link name="$(arg prefix)tcp_link"/>
          <joint name="$(arg prefix)tcp_link_joint" type="fixed">
            <origin xyz="0 0 0.125" rpy="0 0 0"/>
            <parent link="$(arg prefix)hand_e_base_link"/>
            <child link="$(arg prefix)tcp_link"/>
          </joint>
          
          <!-- TCP Link Tube -->
          <link name="$(arg prefix)tcp_link_tube"/>
          <joint name="$(arg prefix)tcp_joint_tube" type="fixed">
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <parent link="$(arg prefix)tcp_link"/>
            <child link="$(arg prefix)tcp_link_tube"/>
          </joint>

          <!-- TCP Link Rack -->
          <link name="$(arg prefix)tcp_link_rack"/>
          <joint name="$(arg prefix)tcp_joint_rack" type="fixed">
            <origin xyz="0 -0.0 0" rpy="0 0 0"/>
            <parent link="$(arg prefix)tcp_link"/>
            <child link="$(arg prefix)tcp_link_rack"/>
          </joint>
    </xacro:macro>
</robot>
